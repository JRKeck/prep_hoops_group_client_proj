prepHoopsApp.controller("SiteController",["$scope","$http","$location","userAuth","$modal","siteFullName",function(t,e,s,r,o,i){console.log("Dashboard script loaded"),t.sites=[],t.dates=[],t.feeds=[],t.authorsWithArticles=[],t.siteName=i.get("siteFullName"),t.authors=[],t.uniqueAuthors=[],t.totalArticles=[],t.dailyAvg=[],t.max=[],t.zeroDays=[],t.Author=function(t,e,s){this.date=t,this.author=e,this.articles=s},console.log(t.siteName),t.onlyUnique=function(t,e,s){return s.indexOf(t)===e},t.getDayOfWeek=function(e){t.dayOfWeek=e.getDay()},t.getFeeds=function(){e.get("/network/getFeeds").success(function(e){t.feeds=e})},t.getAuthors=function(e){for(var s=0;s<e.length;s++)for(var r=0;r<e[s].site.length;r++)if(e[s].site[r].siteName===t.siteName)for(k=0;k<e[s].site[r].articles.length;k++)t.authors.push(e[s].site[r].articles[k].author);for(t.uniqueAuthors=t.authors.filter(t.onlyUnique),s=0;s<e.length;s++){t.authorsWithArticles.push({date:e[s].date,authors:[]});for(var o=0;o<t.uniqueAuthors.length;o++)t.authorsWithArticles[s].authors.push({authorName:t.uniqueAuthors[o],articles:[]}),t.totalArticles[o]=0}t.getAuthorArticles(e)},t.getAuthorArticles=function(e){for(var s=0;s<e.length;s++)for(var r=0;r<e[s].site.length;r++)if(e[s].site[r].siteName===t.siteName)for(var o=0;o<t.uniqueAuthors.length;o++)for(var i=0;i<e[s].site[r].articles.length;i++)e[s].site[r].articles[i].author===t.uniqueAuthors[o]&&(t.totalArticles[o]=t.totalArticles[o]+1,e[s].date===t.authorsWithArticles[s].date&&t.authorsWithArticles[s].authors[o].articles.push(e[s].site[r].articles[i]));console.log(t.totalArticles)},t.getAuthorStats=function(e){t.totalSiteArticles=0;for(var s=0,r=1;18>r;r++){for(var o=0;o<e.length;o++)for(var i=0;i<e[o].site.length;i++)e[o].site[i].siteID===r&&(t.totalSiteArticles=t.totalSiteArticles+e[o].site[i].articles.length,0===e[o].site[i].articles.length&&s++);t.totalArticles.push(t.totalSiteArticles),t.dailyAvg.push(t.totalSiteArticles/e.length),t.zeroDays.push(s),t.totalSiteArticles=0,s=0}},t.getRSS=function(s,r){var o=s.toISOString();t.shortFirstDateString=o.substr(0,o.indexOf("T"));var i=r.toISOString();t.shortSecondDateString=i.substr(0,i.indexOf("T")),e.post("/api/articleGet",[t.shortFirstDateString,t.shortSecondDateString]).success(function(e){t.getFeeds(),t.dates=e,t.sites=e[0].site,t.getAuthors(e)})},t.open=function(e,s){e.preventDefault(),e.stopPropagation(),t[s]=!0},t.status={opened:!1},t.today=function(){t.first=new Date,t.last=new Date},t.today(),t.clear=function(){t.first=null,t.last=null},t.animationsEnabled=!0,t.openModal=function(e){console.log(this),t.selectedArticles=this.author.articles;o.open({animation:t.animationsEnabled,templateUrl:"/assets/views/routes/authorArticleUrl.html",controller:"ArticleInstanceController",size:e,resolve:{selectedArticles:function(){return t.selectedArticles}}})}}]),prepHoopsApp.controller("ArticleInstanceController",["$scope","$modalInstance","selectedArticles",function(t,e,s){t.modalArticles=s,t.articleUrlArray=[];for(var r=0;r<t.modalArticles.length;r++)t.articleUrlArray.push(t.modalArticles[r].url);t.ok=function(){e.close()}}]);